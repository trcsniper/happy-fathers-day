<!DOCTYPE html>
<html>
	<head>
		<title>Happy Father's Day!</title>

		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cherry+Bomb+One">
		<style>
			body {
				margin: 0px;
				padding: 0px;
			}

			.variable-label {
				font-family: 'Times New Roman', Times, serif;
				font-style: italic;
			}

			.variable-value {
				font-weight: bold;
			}

			#parallax-stack {
				overflow: hidden;
				position: relative;
				width: 1920px;
				height: 1080px;
			}

			.parallax {
				position: absolute;
				width: 100%;
				height: 100%;
			}

			.content-background {
				background-image: url(./parallax-layer-back.png);
				background-size: cover;
				background-position-x: center;
				background-position-y: center;
				margin: -10% 0% 0% -10%;
				padding: 10% 10% 10% 10%;
			}

			.content-foreground {
				background-image: url(./parallax-layer-front.png);
				background-size: cover;
				background-position-x: right;
				background-position-y: bottom;
			}

			.content-message {
				background-position-x: center;
				background-position-y: top;
			}

			.content-message div {
				font-family: 'Cherry Bomb One', sans-serif;
				margin-top: 200px;
				font-size: 96pt;
				color: #fff;
				text-align: center;
				line-height: 85%;
			}
		</style>

		<script>
			var parallaxParent;
			var parallaxElements;

			var prevMouseX = 0;
			var prevMouseY = 0;

			var tiltX = 0;
			var tiltY = 0;

			var rotationSampleCount = 4;
			var rotationSampleIndex = 0;
			var rotationSamplesX = [];
			var rotationSamplesY = [];

			window.onload = function() {
				parallaxParent = document.getElementById("parallax-stack");
				parallaxElements = parallaxParent.getElementsByClassName("parallax");

				for (let sampleIndex = 0; sampleIndex < rotationSampleCount; sampleIndex++) {
					rotationSamplesX[sampleIndex] = 0;
					rotationSamplesY[sampleIndex] = 0;
				}

				setCanvasSize(document.documentElement.clientWidth, document.documentElement.clientHeight);

				if (window.DeviceMotionEvent) {
					window.addEventListener(
						"devicemotion",
						function (event) {
							rotationSamplesX[rotationSampleIndex] = event.rotationRate.beta;
							rotationSamplesY[rotationSampleIndex] = event.rotationRate.alpha;
							rotationSampleIndex = ++rotationSampleIndex % rotationSampleCount;

							var averageRotationX = 0;
							var averageRotationY = 0;

							for (let sampleIndex = 0; sampleIndex < rotationSampleCount; sampleIndex++) {
								averageRotationX += rotationSamplesX[sampleIndex];
								averageRotationY += rotationSamplesY[sampleIndex];
							}

							averageRotationX /= rotationSampleCount;
							averageRotationY /= rotationSampleCount;

							tilt(averageRotationX * 0.001, averageRotationY * 0.001);
						},
						true
						);
				}
			}

			window.onresize = function() {
				setCanvasSize(document.documentElement.clientWidth, document.documentElement.clientHeight);
			}

			window.onmousemove = function(event) {
				mouseX = event.clientX;
				mouseY = event.clientY;

				tilt((mouseX - prevMouseX) * 0.001, (mouseY - prevMouseY) * 0.001);

				prevMouseX = mouseX;
				prevMouseY = mouseY;
			}

			function setCanvasSize(x, y) {
				parallaxParent.style.width = x + "px";
				parallaxParent.style.height = y + "px";
			}
			
			function clamp(value, min, max) {
				return Math.max(Math.min(value, max), min);
			}
			
			function tilt(x, y) {
				tiltX = clamp(tiltX + x, -1, 1);
				tiltY = clamp(tiltY + y, -1, 1);

				Array.prototype.forEach.call(
					parallaxElements,
					function(element) {
						var scale = element.getAttribute("parallax-scale");
						element.style.transform = "translate(" + (tiltX * scale * 100) + "%, " + (tiltY * scale * 100) + "%)";
					}
					);
			}
		</script>
	</head>
	<body>
		<div id="parallax-stack">
			<div class="parallax content-background" parallax-scale="-0.05"></div>
			<div class="parallax content-message" parallax-scale="0.02"><div>HAPPY<br />FATHER'S<br />DAY!</div></div>
			<div class="parallax content-foreground" parallax-scale="0.05"></div>
		</div>
	</body>
<html>
